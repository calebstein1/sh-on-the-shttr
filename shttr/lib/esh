printf 'Content-Type: text/html\n\n'

v() {
  view=${SHTTR_APP}/views/${1}
  esh_var=$(grep -o \(\(esh\).*\) $view)
  var_count=$(echo ${esh_var} | wc -w)
  if [ $var_count -eq 0 ]; then
    cat $view
  else
    content=$(cat $view)
    for cur_esh in $esh_var; do
      cur_esh_var=${cur_esh#*)}
      cur_esh_var=${cur_esh_var%)}
      content=$(echo ${content} | sed "s+${cur_esh}+$(printenv ${cur_esh_var})+")
    done
    echo $content
  fi
}
